REM @ECHO OFF
REM This script only deploy's web application and restarts tomcat. If you enter a version, it will deploy that version, otherwise, it looks for the latest version
set /p APP_VERSION="Enter Application Version: "
set /p APP_NAME="Enter Application Name: "
SET Src="\\....\Releases\SCM\Smarts\"
SET Webapps_Dir="%CATALLINA_HOME%"\webapps
if "%APP_NAME%" == "ABC" ( goto Deploy)
else ( goto end )
if "%APP_NAME%" == "DEF" ( goto Deploy )
else ( goto end )
:Deploy
If "%APP_VERSION%" NEQ "" (
set APP_VERSION=%APP_VERSION%
set APP_NAME=%APP_NAME%
call xcopy "%Src%""%APP_VERSIOn%"\"%APP_NAME%"\*.war "%Webapps_Dir%" /Y /I /R
call "%CATALINA_HOME%"\bin\catalina.bat stop
timeout /t 30
call "%CATALINA_HOME%"\bin\catalina.bat start)
else(
FOR /F "tokens=*" %%i IN ('dir %Src% /b /ad-h /t:w /o-d') DO (SET APP_VERSION=%%i)
call xcopy "%Src%""%APP_VERSIOn%"\"%APP_NAME%"\*.war "%Webapps_Dir%" /Y /I /R
call "%CATALINA_HOME%"\bin\catalina.bat stop
timeout /t 30
call "%CATALINA_HOME%"\bin\catalina.bat start	
echo Version Deployed: %APP_VERSION%
)
 :end
 echo The Application you have entered doesn't exist, closing window
 timeout /t 10
 endlocal.
 exit
 
